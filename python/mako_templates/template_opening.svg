<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg preserveAspectRatio="xMinYMin meet" width="${page_w}mm" height="${page_h}mm" viewBox="0 0 ${page_w} ${page_h}"  
     version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<desc>Tag sheet SVG</desc>

<%!
  import math

  in2mm = 25.4
  def apply_hint_mm(val_mm, dpi=300):
    val_in = val_mm / in2mm
    return round(val_in*dpi)/dpi*in2mm

  halfinch=25.4/2
%>

<!-- Definitions -->
<defs>
  <g id="cross">
    <g class="cross">
        <path d="M -5 0 L 5 0 M 0 -5 L 0 5" fill="none" stroke="${crosscolor}" stroke-width="0.02"/>
        <path d="M -5 0 L 0 0 L 0 5 A 5 5 0 0 1 -5 0" fill="none"  stroke="${crosscolor}" stroke-width="0.02"/>
        <path d="M 5 0 L 0 0 L 0 -5 A 5 5 0 0 1 5 0" fill="none"  stroke="${crosscolor}" stroke-width="0.02"/>
    </g>
    <g class="ruler">
        <g id="mmrule">
          <path d="M -1 0 l 0 -0.8  m -1 0.8 l 0 -0.8  m -1 0.8 l 0 -0.8  m -1 0.8 l 0 -0.8  m -1 0.8 l 0 -0.8" fill="none" stroke="${crosscolor}" stroke-width="0.05"/>
        </g>
        <use xlink:href="#mmrule" transform="rotate(90)"/>
        <use xlink:href="#mmrule" transform="rotate(180)"/>
        <use xlink:href="#mmrule" transform="rotate(-90)"/>
        <text text-anchor="start" dominant-baseline="middle" x="+1" y="-3"
                    font-family="Helvetica" font-size="1.0"
                    fill="#000000" xml:space="preserve">1mm</text>
                    
        <g id="in100rule">
          <path d="M -1 0 l 0 3  m -1 -3 l 0 3  m -1 -3 l 0 3  m -1 -3 l 0 3  m -1 -3 l 0 4  m -1 -4 l 0 3  m -1 -3 l 0 3  m -1 -3 l 0 3  m -1 -3 l 0 3  m -1 -3 l 0 4" fill="none" stroke="${crosscolor}" stroke-width="${0.05*100/25.4}" transform="scale(${25.4/100})"/>
        </g>
        <use xlink:href="#in100rule" transform="rotate(90)"/>
        <use xlink:href="#in100rule" transform="rotate(180)"/>
        <use xlink:href="#in100rule" transform="rotate(-90)"/>
        <text text-anchor="end" dominant-baseline="middle" x="-0.5" y="-3"
                  font-family="Helvetica" font-size="1.0"
                  fill="#000000" xml:space="preserve">0.01in</text>
    </g>
  </g>
  <g id="crosscut">
    <g class="cross">
        <path d="M -2 0 L 2 0 M 0 -2 L 0 2" fill="none" stroke="#0F0" stroke-width="0.03"/>
    </g>
  </g>
  
  <%include file="template_checkers.svg"/>
    
  <g id="testpattern">
  <g transform="translate(0,${halfinch*0})">
    <% s=25.4/1200 %>
    <text text-anchor="middle" dominant-baseline="alphabetic" dy="-1"
                  font-family="Helvetica" font-size="1"
                  fill="#000000" xml:space="preserve">1200ppi</text>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(-22,0)"/>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(2.5,0.5)"/>
  </g>
  <g transform="translate(0,${halfinch*1})">
    <% s=25.4/600 %>
    <text text-anchor="middle" dominant-baseline="alphabetic" dy="-1"
                  font-family="Helvetica" font-size="1"
                  fill="#000000" xml:space="preserve">600ppi</text>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(-22,0)"/>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(2.5,0.5)"/>
  </g>
  <g transform="translate(0,${halfinch*2})">
    <% s=25.4/300 %>
    <text text-anchor="middle" dominant-baseline="alphabetic" dy="-1"
                  font-family="Helvetica" font-size="1"
                  fill="#000000" xml:space="preserve">300ppi</text>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(-22,0)"/>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(2.5,0.5)"/>
  </g>
  <g transform="translate(0,${halfinch*3})">
    <% s=pix2mm %>
    <text text-anchor="middle" dominant-baseline="alphabetic" dy="-1"
                  font-family="Helvetica" font-size="1"
                  fill="#000000" xml:space="preserve">tag: ${"{:.1f}".format(25.4/pix2mm)}ppi</text>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(-22,0)"/>
    <use xlink:href="#checkers" transform="scale(${s},${s}) translate(2.5,0.5)"/>
  </g>
  <g transform="translate(0,${halfinch*6})">
     <%include file="template_siemensstar.svg"/>
  </g>
  </g> <!-- Test pattern -->
</defs>

<g id="topgroup">

<!-- Alignment Crosses -->

<%
  x0=axismargin_left
  y0=axismargin_top
  x1=page_w-axismargin_left
  y1=page_h-axismargin_top
%>

<g id="alignmentCrosses">
  <use xlink:href="#cross" transform="translate(${x0},${y0})"/>
  <use xlink:href="#cross" transform="translate(${x1},${y0}) scale(-1,1)"/>
  <use xlink:href="#cross" transform="translate(${x1},${y1}) scale(-1,-1)"/>
  <use xlink:href="#cross" transform="translate(${x0},${y1}) scale(1,-1)"/>
  
%if show_tag_cut:
  <use xlink:href="#crosscut" transform="translate(${x0},${y0})"/>
  <use xlink:href="#crosscut" transform="translate(${x1},${y0}) scale(-1,1)"/>
  <use xlink:href="#crosscut" transform="translate(${x1},${y1}) scale(-1,-1)"/>
  <use xlink:href="#crosscut" transform="translate(${x0},${y1}) scale(1,-1)"/>
%endif
</g>

%if show_test_patterns:
<g id="testPatterns">
<%
  testpattern_cx = apply_hint_mm(page_w-halfinch*1.25,50)
  testpattern_y0 = halfinch*8
%>
  <use xlink:href="#testpattern" transform="translate(${testpattern_cx},${testpattern_y0})"/>
  
<%
  testpattern_cx = halfinch
  testpattern_y0 = halfinch*6
%>
  <use xlink:href="#testpattern" transform="translate(${testpattern_cx},${testpattern_y0})"/>
</g>
%endif